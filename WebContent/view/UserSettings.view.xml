<core:View
	controllerName="com.tasky.controller.UserSettings"
	xmlns="sap.m"
	xmlns:core="sap.ui.core"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:semantic="sap.m.semantic"
	xmlns:unified="sap.ui.unified"
	xmlns:form="sap.ui.layout.form">

	<semantic:DetailPage
		title="{i18n>USER.SETTINGS}">
		<semantic:customHeaderContent>
			<core:Fragment fragmentName="com.tasky.fragment.DetailNavigationButtons" type="XML" />
		</semantic:customHeaderContent>

		<semantic:saveAction>
			<semantic:SaveAction icon="sap-icon://save" text="{i18n>ACTIONS.SAVE}" press="onPressSave" />
		</semantic:saveAction>

		<form:SimpleForm id="userDataForm"
	        maxContainerCols="1"
	        editable="true"
	        layout="ResponsiveGridLayout"
	        labelSpanL="3" labelSpanM="3"
	        emptySpanL="2" emptySpanM="2"
	        columnsL="2" columnsM="2">
			<form:content>
				<core:Title text="{i18n>USER.INFO}" />
				<Label text="{i18n>USER.USERNAME}" design="Bold" />
				<Input id="usernameField"
					value="{/Temp/CurrentUser/username}" />
				<!-- TODO: personalised icons probably don't matter while we're only using a local single-user model
				<Label text="{i18n>USER.ICON}" design="Bold" />
				<core:Icon
					src="{/Temp/CurrentUser/icon}" />
				<Label text="{i18n>USER.ICON}" design="Bold" />
				<Text id="ownerDisplay"
					text="{/Temp/CurrentUser/icon}" design="Bold" />
				-->
				<core:Title text="{i18n>SETTINGS.SETTINGS}" />
				<Label text="{i18n>GENERAL.LANGUAGE}" design="Bold" />
				<Select id="languageDropdown"
					forceSelection="false"
					selectedKey="{/Temp/CurrentUser/language}"
					items="{lang>/Languages}">
					<core:Item key="{lang>key}" text="{lang>name}" />
				</Select>

				<core:Title />
				<Panel
					expandable="true"
					expanded="false"
					headerText="{i18n>SETTINGS.DATA_ACTIONS}">
					<content>
						<HBox
							alignItems="Start"
				            justifyContent="Start">
							<items>
								<Button
									width="100%"
									type="Reject"
									icon="sap-icon://delete"
									text="{i18n>SETTINGS.CLEAR_ALL}"
									press="onPressClearAll">
									<layoutData>
										<FlexItemData growFactor="1" />
									</layoutData>
								</Button>
							</items>
						</HBox>

						<HBox
							alignItems="Start"
				            justifyContent="Start">
							<items>
								<Button
									width="100%"
									icon="sap-icon://synchronize"
									text="{i18n>SETTINGS.FORCE_SYNC}"
									press="onPressForceSync">
									<layoutData>
										<FlexItemData growFactor="1" />
									</layoutData>
								</Button>
							</items>
						</HBox>
					</content>
				</Panel>

				<core:Title />
				<Panel
					expandable="true"
					expanded="false"
					headerText="{i18n>SETTINGS.FILE_ACTIONS}">
					<content>
						<HBox
							alignItems="Start"
				            justifyContent="Start">
							<items>
								<unified:FileUploader id="fileUploader"
									width="100%"
									value="{file>/Filepath}"
									fileType="['json']"
									change="onChangeFile"
									typeMissmatch="onTypeMismatch"
									uploadComplete="onUploadComplete" />
							</items>
						</HBox>
						<HBox
							alignItems="Start"
				            justifyContent="Start">
							<items>
								<Button
									width="100%"
									icon="sap-icon://inbox"
									text="{i18n>SETTINGS.IMPORT}"
									press="onPressImport">
									<layoutData>
										<FlexItemData growFactor="1" />
									</layoutData>
								</Button>
								<Button
									width="100%"
									icon="sap-icon://outbox"
									text="{i18n>SETTINGS.EXPORT}"
									press="onPressExport">
									<layoutData>
										<FlexItemData growFactor="1" />
									</layoutData>
								</Button>
							</items>
						</HBox>
					</content>
				</Panel>
			</form:content>
		</form:SimpleForm>
    </semantic:DetailPage>
</core:View>
